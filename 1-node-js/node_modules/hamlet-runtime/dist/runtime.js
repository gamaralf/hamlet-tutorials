!function(){var Observable,Runtime,bindEvent,bindObservable,cleanup,empty,eventNames,isEvent,isFragment,remove,specialBindings,valueBind,valueIndexOf,__slice=[].slice;Observable=require("o_0");eventNames="abort\nblur\nchange\nclick\ndblclick\ndrag\ndragend\ndragenter\ndragleave\ndragover\ndragstart\ndrop\nerror\nfocus\ninput\nkeydown\nkeypress\nkeyup\nload\nmousedown\nmousemove\nmouseout\nmouseover\nmouseup\nreset\nresize\nscroll\nselect\nsubmit\ntouchcancel\ntouchend\ntouchenter\ntouchleave\ntouchmove\ntouchstart\nunload".split("\n");isEvent=function(name){return eventNames.indexOf(name)!==-1};isFragment=function(node){return(node!=null?node.nodeType:void 0)===11};valueBind=function(element,value,context){var update;value=Observable(value,context);switch(element.nodeName){case"SELECT":element.oninput=element.onchange=function(){var optionValue,_ref,_value;_ref=this.children[this.selectedIndex],optionValue=_ref.value,_value=_ref._value;return value(_value||optionValue)};update=function(newValue){var options;element._value=newValue;if(options=element._options){if(newValue.value!=null){return element.value=(typeof newValue.value==="function"?newValue.value():void 0)||newValue.value}else{return element.selectedIndex=valueIndexOf(options,newValue)}}else{return element.value=newValue}};bindObservable(element,value,context,update);break;default:element.oninput=element.onchange=function(){return value(element.value)};bindObservable(element,value,context,function(newValue){return element.value=newValue})}};specialBindings={INPUT:{checked:function(element,value,context){element.onchange=function(){return typeof value==="function"?value(element.checked):void 0};return bindObservable(element,value,context,function(newValue){return element.checked=newValue})}},SELECT:{options:function(element,values,context){var updateValues;values=Observable(values,context);updateValues=function(values){empty(element);element._options=values;return values.map(function(value,index){var option,optionName,optionValue;option=document.createElement("option");option._value=value;if(typeof value==="object"){optionValue=(value!=null?value.value:void 0)||index}else{optionValue=value.toString()}bindObservable(option,optionValue,value,function(newValue){return option.value=newValue});optionName=(value!=null?value.name:void 0)||value;bindObservable(option,optionName,value,function(newValue){return option.textContent=newValue});element.appendChild(option);if(value===element._value){element.selectedIndex=index}return option})};return bindObservable(element,values,context,updateValues)}}};bindObservable=function(element,value,context,update){var observable,observe,unobserve;observable=Observable(value,context);observe=function(){observable.observe(update);return update(observable())};unobserve=function(){return observable.stopObserving(update)};observe();(element._hamlet_cleanup||(element._hamlet_cleanup=[])).push(unobserve);return element};bindEvent=function(element,name,fn,context){return element[name]=function(){return fn.apply(context,arguments)}};cleanup=function(element){var _ref;Array.prototype.forEach.call(element.children,cleanup);if((_ref=element._hamlet_cleanup)!=null){_ref.forEach(function(method){return method()})}delete element._hamlet_cleanup};Runtime=function(context){var append,classes,id,lastParent,observeAttribute,observeText,pop,push,render,self,stack,top,withContext;stack=[];lastParent=function(){var element,i;i=stack.length-1;while((element=stack[i])&&isFragment(element)){i-=1}return element};top=function(){return stack[stack.length-1]};append=function(child){var parent,_ref;parent=top();if(parent&&isFragment(child)&&child.childNodes.length===1){child=child.childNodes[0]}if((_ref=top())!=null){_ref.appendChild(child)}return child};push=function(child){return stack.push(child)};pop=function(){return append(stack.pop())};render=function(child){push(child);return pop()};id=function(){var element,sources,update,value;sources=1<=arguments.length?__slice.call(arguments,0):[];element=top();update=function(newValue){if(typeof newValue==="function"){newValue=newValue()}return element.id=newValue};value=function(){var possibleValues;possibleValues=sources.map(function(source){if(typeof source==="function"){return source()}else{return source}}).filter(function(idValue){return idValue!=null});return possibleValues[possibleValues.length-1]};return bindObservable(element,value,context,update)};classes=function(){var element,sources,update;sources=1<=arguments.length?__slice.call(arguments,0):[];element=top();update=function(newValue){if(typeof newValue==="function"){newValue=newValue()}return element.className=newValue};return function(context){var value;value=function(){var possibleValues;possibleValues=sources.map(function(source){if(typeof source==="function"){return source.call(context)}else{return source}}).filter(function(sourceValue){return sourceValue!=null});return possibleValues.join(" ")};return bindObservable(element,value,context,update)}(context)};observeAttribute=function(name,value){var binding,element,nodeName,_ref;element=top();nodeName=element.nodeName;if(name==="value"){valueBind(element,value)}else if(binding=(_ref=specialBindings[nodeName])!=null?_ref[name]:void 0){binding(element,value,context)}else if(name.match(/^on/)&&isEvent(name.substr(2))){bindEvent(element,name,value,context)}else if(isEvent(name)){bindEvent(element,"on"+name,value,context)}else{bindObservable(element,value,context,function(newValue){if(newValue!=null&&newValue!==false){return element.setAttribute(name,newValue)}else{return element.removeAttribute(name)}})}return element};observeText=function(value){var element,update,_ref;value=Observable(value,context);switch((_ref=value())!=null?_ref.nodeType:void 0){case 1:case 3:case 11:return render(value())}element=document.createTextNode("");update=function(newValue){return element.nodeValue=newValue};bindObservable(element,value,context,update);return render(element)};withContext=function(newContext,fn){var oldContext;oldContext=context;context=newContext;try{return fn()}finally{context=oldContext}};self={push:push,pop:pop,id:id,classes:classes,attribute:observeAttribute,text:observeText,filter:function(name,content){},each:function(items,fn){var elements,parent,replace;items=Observable(items,context);elements=null;parent=lastParent();items.observe(function(){return replace(elements)});replace=function(oldElements){elements=[];items.each(function(item,index,array){var element;element=null;withContext(item,function(){return element=fn.call(item,item,index,array)});if(isFragment(element)){elements.push.apply(elements,element.childNodes)}else{elements.push(element)}parent.appendChild(element);return element});return oldElements!=null?oldElements.forEach(remove):void 0};return replace(null,items)}};return self};Runtime.Observable=Observable;module.exports=Runtime;empty=function(node){var child,_results;_results=[];while(child=node.firstChild){_results.push(node.removeChild(child))}return _results};valueIndexOf=function(options,value){if(typeof value==="object"){return options.indexOf(value)}else{return options.map(function(option){return option.toString()}).indexOf(value.toString())}};remove=function(element){var _ref;cleanup(element);if((_ref=element.parentNode)!=null){_ref.removeChild(element)}}}.call(this);